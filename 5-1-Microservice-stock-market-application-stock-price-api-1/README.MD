# To run whole project using below url

# http://localhost:8761/ (To run first application) (5-stock-market-application-using-microservice-eureka-server-1)

# http://192.168.1.101:1111/price/HCL  (2nd applicationURL which is REST-API STOCK-PRICE-API i.e 5-1-MicroService-market-application-stock-price-api-1)

# http://192.168.1.101:2222/stock/calc/HCL/2  (3RD ApplicationURL which is REST-API STOCK-CALC-API i.e 5-2-MicroService-stock-implementation-STOCK-CALC-API)


#  --------------------------------------- Start Load balancing & How it implements ----------------------------------------------------------------------------------------------------------

# To reduce burden on one server we use load balancing, LBR(Load balancer) will decide which server will handle the which request if we have multiple server on which our application is running, LBR using following algorithm to decide which server handle the which request
#  1) Round-robin :- It will follow sequence manner to handle the request like first request handle by first server and so on...
#  2) Sticky-session:- my application having a session  and my request process by first server and created session on first server,and if request go to second server my session is not their then how to manage whenever your application dealing with session use sticky-session algorithm.How it work?Ans:-whenever request comes it goes to LBR and request process by first server and session created on first server then your all request will go to first server. so on which server your session is created, all request will be handle by
# that server only.
#  3) ip-hashing:- They will write on hash function which will generate number based on your ip address b/w 1 to 9 server.I write a function for that function i passed ip address as a parameter and  inside that function they wrote logic in that manner request will be handle by 1 to 9 server only because in our scenario's we have only 9 server. which  will return server no(b/w 1 to 9) and assign request to that server.

# has(ip){
return serverNum;
}

# just taking an example like facebook handle billion of request a at time so they  use LBR concept , did they give different-different url on which server request was handle ? Ans:- only one url (www.facebook.com)which was given to all the users and that url is of load balancer instead of every server url.

# All nine server having the same war and they connect to same database because database property for all server war is same/common.application which running on 9's server is it same or not ans:- same war/application difference is only that when x user send a request to application it handle by suppose 1st server, when y user send request to 4th server and so on....

# Q:-  A request comes to server directly or not ? Ans:- No , first it goes to LBR then LBR will decide this request is handle by which server based on above algorithm. LBR having DNS(like facebook.com is a DNS ) ,all nine server having 9 different urls , our request go to LBR instead of server , in LBR DNS mapping is their , like www.facebook.com which is a DNS which binds to 9's server URL,networking configuration is available in LBR.

# Scaling :- to adding more number of server know as scale up, to removing server known as scale down.
# scale up & scale down is provide high availability of system. Here 2 ways to scale-up & scale-down
# 1. Manual Scale UP/Manual Scale Down
# 2.Automatic Scale UP/Automatic Scale down.:- Based on Incoming request server will add automatically, like if existing 9's server will not capable to handle the 1000's no of request then server will add automatically example:- Amazon Big Day Sale
#  based on request it will identify whether no of server which are exist are they sufficient or not ? If not adding server initially 10 but if request in one seconds are coming billions then they added more server so on. suppose till at 2 am these billion of request are coming but after that request/traffic are reducing then we have to reduce the server but manually to reduce/add up  server is highly complicated so if it automatic , if traffic/request are reduce in case of automatic it will reduce/add the request.

# Refer image (LoadBalancing&comunicationofstockapps.png) according to this image we are running 3 instance of  stock-price-api which are running on port 1111,1122,1133, and stock-calc-api is running only on one instance. To run multiple instance of stock-rest-api in intellij in mac using cmd + 8 commands,now service on bottom is open below then click on '+' icon and add more option like VM Option  -Dserver.port = 1111, Dserver.port = 1122, Dserver.port = 1133.

# explanation of this image (LoadBalancing&comunicationofstockapps.png) 

# Here i have taken stock-price-api first,this is running in 3 instances(servers) means same api is running on 3 server's, what are the port number of these instances/server , one server is running on 1111,2nd server is running on 1122,3rd server is running on 1133,and this api also having DB , it connecting with database also,all instances are connecting with same database because database configuration is same, we having one more application STOCK-CALC-API which having the Feign Client, what is the purpose of this Feign Client ? Ans:- it is used for inter-service-communication,Q:- To the Feign-Client am i giving the url of rest api or name of restapi ?  Ans:- Name of the restapi, Now Feign client connect/register with eureka server(service registry) to get the url why? because i have given the name of rest api , based on name  of rest api it will get url of the rest api service and send the request to this url. 
# STOCK-CALC-API is running on 2222 port no these api have registered with eureka sever which is known as service-registry,service-registry is used to register all the services, what are all the services ? Ans:- all instances(instance-1,instance-2,instance-3) of STOCK-PRICE-API all are having 3 different url and all are registered to eureka,similar STOCK-CALC-API is also registered with eureka server, how many instance of  STOCK-CALC-API are running ? Ans:- only one instance, and inside the STOCK-CALC-API having Feign Client.Feign Client communicate with STOCK-PRICE-API this is called as Interservice communication.STOCK-PRICE-API is running on 3's servers, why we run multiple instance/server of STOCK-PRICE-API ? Because thousands of multiple request are coming to STOCK-PRICE-API,I want to do
# load balancing to reduce burden on one server, i don't want to give the all request to single server, i want to distribute the load to multiple server that is why instead of running STOCK-PRICE-API on single server we are running on multiple server. We are having API-Gateway, which is used to manage our backend api's available in our application.which one using as api gateway:- spring cloud gateway, what is the configuration in API-GATEWAY ? ANS:- We have routings in API-GATEWAY, it is also registered with EUREKA-SERVER as client. Eureka server is running on prot no 8761 and API-GATEWAY is running on port no 3333.
# if url contains Path=/price/** it will go to first rest api which is STOCK-PRICE-API(spa) AND if url contains Path=stock/calc/** it will go to STOCK-CALC-API(sca). In this scenario's we are sending the request to backend api directly or by the  API-GATEWAY ? Ans:- Request will go to API-GATEWAY and response also come from API-GATEWAY. FROM UI request go to API-GATEWAY and response came from API-GATEWAY.

# suppose i want access STOCK-CALC-API do i need to send request directly to STOCK-CALC-API with two parameter(cname,qty input) and we get output totalcost(which we calculate quantity* costOFCompanyStock) and price-api port number  and why we need port number of STOCK-PRICE-API? because to know load balancing is working in STOCK-REST-API Q:-  do i send a request to API-GATEWAY or backend rest api directly ? anS:- I need to send the request to API-GATEWAY , and request will be http://192.168.1.102:8080/stock/calc/HCL/2 here http:http://192.168.1.102:8080 this is the DNS of API-GATEWAY,
# and get respons {"companyName":"HCL","portNumber":1113,"quantity":2,"totalCost":1900.0},
# here portNumber is 1113 which server handle the request answer is 3rd server of STOCK-REST-API because STOCK-REST-API is running on 3 server's, here request is processed by 3rd server. NOW again i am hitting this url http://192.168.1.102:8080/stock/calc/HCL/2 i got response {"companyName":"HCL","portNumber":1112,"quantity":2,"totalCost":1900.0} i.e request process by 2nd sever of STOCK-REST-API's. Here which algorithm is working ? Ans:- Round-Robin algo used by LBR.(Load balancing).

# How many services are running in our project see from image (LoadBalancing&comunicationofstockapps.png) ?
# Ans :- 6 (3+1+1+1) because 3 instances/server of stock-price-api(3) , one eureka server(1),one api gateway(1),stock-calc-api(1). These services are running on single server or different-2 server ? Ans:- different server but machine are same(i.e my system).
# Q:- which service maintain url and name of rest api/services? ANS: EUREKA-SERVER(refer this image URL-MAPPING-SERVICE-IN-EUREKA.png )
# this url is http://192.168.1.102:8080/stock/calc/HCL/2 stock-calc-api url or api-gateway url ? Ans:- api-gateway-url.
# here http://192.168.1.102:8080/stock/calc/HCL/2 this url contains the url pattern /stock/calc** so api-gateway perform routing and gives this request to STOCK-CALC-API(sca), sca(stock-calc-api) is responsible to handle this request stock-calc-api take SBI and 10 as path variables(companyname and quantity) they went input for calc api , it using feign client to communicate with STOCK-PRICE-API, for the feign client am i giving url or service/REST API name of STOCK-PRICE-API ? Ans: Service/Rest api Name OF STOCK-PRICE-API and how Feign client get url of REST API i.e STOCK-PRICE-API ? ANS: - It will talk to service registry, because service registry knows url and api name  or service registry maintain rest api url and rest api name, then feign client say to eureka i have name of the restapi/service give me the url of service/rest api , now eureka service will check what is the url of given restapi/service api, here for STOCK-PRICE-API having 3 url's instead of one? Here we have dynamic url's of 3 server of STOCK-PRICE-API or static ? Ans:- Dynamic url that is the reason why we are giving REST-API name instead of url and if we give url instead of name it will always give request to that url,
#  Here feign client when ask url from eureka-server , now eureka-server having 3 server url of STOCK-PRICE-API. Here eureka server will give 3's server url because STOCK-PRICE-API is running on 3 server now feign client get confused which url it have to use  now Feign-Client use internally a feature call ribbon, ribbon is in-built feature in feign client which uses to achieve  client-side-load-balancing, why it's called client-side-load-balancing ? Ans:- DO you have any LBR at the server  to decide which request is handle by which server ? Do you have any LBR at STOCK-REST-API Ans:- No LBR, it just running on 3's server so Q :- where it had decide which server will handle the request ? Ans:- It decide At Client Side only ,Ribbon is available where ? Ans:- IT available in feign-client side ,feign client is nothing it is a client side component ,At the client side only it will decide which url is used to access STOCK-PRICE-API as it is decide at client side so it is known as client side balancing so here ribbon is using round-robin algorithm , first request will go first sever, second request will go to second server etc, For client-side-load-balancing we use ribbon Q:-  what is ribbon ? ANS:- Ribbon is used to achieve client side load balancing in microservice.Ribbon is in-built
# in feign-client.when we use annotation @FeignClient  it uses Ribbon which internally use client-side-load-balancing.instead of using LBR at server side we are using Ribbon to achieve client-side-load-balancing
# but we are using load balancing for load balancing url is the same or changed everytime ? Ans:- its changed  when you perform scale-up/scale-down (adding more server/remove server) url is changed,because It depends on load balancing which service handle this incoming request based on algorithm (round-robin,stick session,hashing).

# Qus:- WHAT IS Ribbon and what is the purpose of ribbon ? Ans:-  Ribbon is used to achieve client-side-load-balancing.
# Qus:- Do i need to add Ribbon manually or it is inbuilt in the client ? Ans:- Inbuilt in the Feign client.

# We know this load-balancing concept by using port number in response in stock-calc-api and stock-rest-api , i am hitting this url http://192.168.1.102:8080/stock/calc/HCL/2 i got response {"companyName":"HCL","portNumber":1112,"quantity":2,"totalCost":1900.0} i.e request process by 2nd sever of STOCK-REST-API's this is confirm by only portnumber , when i again hit this url i got response with different port number which means it handle by 3 server or some different server.

# Qus: Difference between client-side-load-balancing or server-side-balancing ?
# Ans:- In server-side-load-balancing we have LBR which decide which server handle the incoming request using load-balancing algorithms.
# In client-side-balancing: in this client-side-balancing Ribbon is their , Ribbon will decide to which server we have to send the request.As it is decide at client side so known as client-side-load-balancing.


# -------------------------------- End Load balancing concept---------------------------------------------------------------------------------------------------------------------------------------

